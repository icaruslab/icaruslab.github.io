<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.110.0">
<link rel="alternate" type="application/rss&#43;xml" href="../docs/ddos-mitigation-guide/index.xml">
<link rel="alternate" type="text/html" href="../docs/ddos-mitigation-guide/_print.html">
<meta name="robots" content="index, follow">


<link rel="shortcut icon" href="../favicons/favicon.ico" >
<link rel="apple-touch-icon" href="../favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="../favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="../favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="../favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="../favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="../favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="../favicons/android-192x192.png" sizes="192x192">

<title>DDoS mitigation guide | Icarus Project</title>
<meta name="description" content="DDoS mitigation guide
">
<meta property="og:title" content="DDoS mitigation guide" />
<meta property="og:description" content="DDoS mitigation guide
" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/docs/ddos-mitigation-guide.html" /><meta property="og:image" content="/images/misc/logo.png"/><meta property="og:site_name" content="Icarus Project" />
<meta itemprop="name" content="DDoS mitigation guide">
<meta itemprop="description" content="DDoS mitigation guide
"><meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/images/misc/logo.png"/>

<meta name="twitter:title" content="DDoS mitigation guide"/>
<meta name="twitter:description" content="DDoS mitigation guide
"/>




<link rel="preload" href="../scss/main.min.97f3cb6b3a7a3b01e5769970dfd6c6735194f4357c93cac16f91211734b2ff7e.css" as="style">
<link href="../scss/main.min.97f3cb6b3a7a3b01e5769970dfd6c6735194f4357c93cac16f91211734b2ff7e.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK"
  crossorigin="anonymous"></script>
<script
  src="https://unpkg.com/lunr@2.3.9/lunr.min.js"
  integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli"
  crossorigin="anonymous"></script>
<meta http-equiv="onion-location" content="http://icarus2yms7lbd33rlmfois75eeicqbn5nh7dnzvnf23bg2jwv4eilad.onion" />
  </head>
  <body class="td-section">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="../">
		<span class="navbar-logo"></span><span class="font-weight-bold">Icarus Project</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="../about.html" ><span>About</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link active" href="../docs.html" ><span class="active">Documentation</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="../blog.html" ><span>Blog</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="../community.html" ><span>Community</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="../mirrors.html" ><span>Mirrors</span></a>
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block"><input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search this site…"
  aria-label="Search this site…"
  autocomplete="off"
  
  data-offline-search-index-json-src="../offline-search-index.e538cf945a21c8cf9e4e1110888911ee.json"
  data-offline-search-base-href="../"
  data-offline-search-max-results="10"
>
</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            
<div id="td-sidebar-menu" class="td-sidebar__inner">
  <form class="td-sidebar__search d-flex align-items-center">
    <input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search this site…"
  aria-label="Search this site…"
  autocomplete="off"
  
  data-offline-search-index-json-src="../offline-search-index.e538cf945a21c8cf9e4e1110888911ee.json"
  data-offline-search-base-href="../"
  data-offline-search-max-results="10"
>

    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  <nav class="collapse td-sidebar-nav" id="td-section-nav">
    <ul class="td-sidebar-nav__section pr-md-3 ul-0">
      <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-docshtml-li">
  <a href="../docs.html" class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id="m-docshtml"><span class="">Documentation</span></a>
  <ul class="ul-1">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsoverviewhtml-li">
  <a href="../docs/overview.html" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsoverviewhtml"><span class="">Overview</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsgetting-startedhtml-li">
  <a href="../docs/getting-started.html" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsgetting-startedhtml"><span class="">Getting Started</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsstatic-mirroringhtml-li">
  <a href="../docs/static-mirroring.html" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsstatic-mirroringhtml"><span class="">Static mirroring</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsstatic-mirroringwget-guidehtml-li">
  <a href="../docs/static-mirroring/wget-guide.html" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsstatic-mirroringwget-guidehtml"><span class="">Wget</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsstatic-mirroringhttrack-guidehtml-li">
  <a href="../docs/static-mirroring/httrack-guide.html" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsstatic-mirroringhttrack-guidehtml"><span class="">HTTrack</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsstatic-mirroringwppluginshtml-li">
  <a href="../docs/static-mirroring/wpplugins.html" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsstatic-mirroringwppluginshtml"><span class="">WordPress Plugins</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsstatic-mirroringstatic-hostinghtml-li">
  <a href="../docs/static-mirroring/static-hosting.html" title="Static mirror hosting" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsstatic-mirroringstatic-hostinghtml"><span class="">Hosting</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsstatic-mirroringstatic-hostingamazons3html-li">
  <a href="../docs/static-mirroring/static-hosting/amazons3.html" title="Hosting on Amazon S3" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsstatic-mirroringstatic-hostingamazons3html"><span class="">Amazon S3</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsstatic-mirroringstatic-hostinggcshtml-li">
  <a href="../docs/static-mirroring/static-hosting/gcs.html" title="Hosting on Google Cloud Storage" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsstatic-mirroringstatic-hostinggcshtml"><span class="">Google CS</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsstatic-mirroringstatic-hostinggithubhtml-li">
  <a href="../docs/static-mirroring/static-hosting/github.html" title="Hosting on GitHub" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsstatic-mirroringstatic-hostinggithubhtml"><span class="">GitHub</span></a>
</li>
  </ul>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsdynamic-mirroringhtml-li">
  <a href="../docs/dynamic-mirroring.html" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsdynamic-mirroringhtml"><span class="">Dynamic Mirroring</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsdynamic-mirroringdecoyhtml-li">
  <a href="../docs/dynamic-mirroring/decoy.html" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsdynamic-mirroringdecoyhtml"><span class="">Decoy</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsalternative-publishing-methodshtml-li">
  <a href="../docs/alternative-publishing-methods.html" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsalternative-publishing-methodshtml"><span class="">Alternative Publishing Methods</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsalternative-publishing-methodstorhtml-li">
  <a href="../docs/alternative-publishing-methods/tor.html" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsalternative-publishing-methodstorhtml"><span class="">Tor</span></a>
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsalternative-publishing-methodstorintrohtml-li">
  <a href="../docs/alternative-publishing-methods/tor/intro.html" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsalternative-publishing-methodstorintrohtml"><span class="">Intro to Tor</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsalternative-publishing-methodstoreotkhtml-li">
  <a href="../docs/alternative-publishing-methods/tor/eotk.html" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsalternative-publishing-methodstoreotkhtml"><span class="">EOTK</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsalternative-publishing-methodstorstaticonionhtml-li">
  <a href="../docs/alternative-publishing-methods/tor/staticonion.html" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsalternative-publishing-methodstorstaticonionhtml"><span class="">Static Onion</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsalternative-publishing-methodsipfsipfshtml-li">
  <a href="../docs/alternative-publishing-methods/ipfs/ipfs.html" title="Interplanetary File System" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsalternative-publishing-methodsipfsipfshtml"><span class="">IPFS</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsddos-mitigation-guidehtml-li">
  <a href="../docs/ddos-mitigation-guide.html" class="align-left pl-0 active td-sidebar-link td-sidebar-link__section" id="m-docsddos-mitigation-guidehtml"><span class="td-sidebar-nav-active-item">DDoS mitigation guide</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docscontribution-guidelineshtml-li">
  <a href="../docs/contribution-guidelines.html" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docscontribution-guidelineshtml"><span class="">Contribution Guidelines</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsreferencehtml-li">
  <a href="../docs/reference.html" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsreferencehtml"><span class="">References</span></a>
</li>
  </ul>
</li>
    </ul>
  </nav>
</div>

          </aside>
          <aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
            
<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
<a href="https://github.com/icaruslab/docs/tree/master/content/en/docs/DDoS%20mitigation%20guide/_index.md" class="td-page-meta--view" target="_blank" rel="noopener"><i class="fa fa-file-alt fa-fw"></i> View page source</a>
  <a href="https://github.com/icaruslab/docs/edit/master/content/en/docs/DDoS%20mitigation%20guide/_index.md" class="td-page-meta--edit" target="_blank" rel="noopener"><i class="fa fa-edit fa-fw"></i> Edit this page</a>
  <a href="https://github.com/icaruslab/docs/new/master/content/en/docs/DDoS%20mitigation%20guide/_index.md?filename=change-me.md&amp;value=---%0Atitle%3A&#43;%22Long&#43;Page&#43;Title%22%0AlinkTitle%3A&#43;%22Short&#43;Nav&#43;Title%22%0Aweight%3A&#43;100%0Adescription%3A&#43;%3E-%0A&#43;&#43;&#43;&#43;&#43;Page&#43;description&#43;for&#43;heading&#43;and&#43;indexes.%0A---%0A%0A%23%23&#43;Heading%0A%0AEdit&#43;this&#43;template&#43;to&#43;create&#43;your&#43;new&#43;page.%0A%0A%2A&#43;Give&#43;it&#43;a&#43;good&#43;name%2C&#43;ending&#43;in&#43;%60.md%60&#43;-&#43;e.g.&#43;%60getting-started.md%60%0A%2A&#43;Edit&#43;the&#43;%22front&#43;matter%22&#43;section&#43;at&#43;the&#43;top&#43;of&#43;the&#43;page&#43;%28weight&#43;controls&#43;how&#43;its&#43;ordered&#43;amongst&#43;other&#43;pages&#43;in&#43;the&#43;same&#43;directory%3B&#43;lowest&#43;number&#43;first%29.%0A%2A&#43;Add&#43;a&#43;good&#43;commit&#43;message&#43;at&#43;the&#43;bottom&#43;of&#43;the&#43;page&#43;%28%3C80&#43;characters%3B&#43;use&#43;the&#43;extended&#43;description&#43;field&#43;for&#43;more&#43;detail%29.%0A%2A&#43;Create&#43;a&#43;new&#43;branch&#43;so&#43;you&#43;can&#43;preview&#43;your&#43;new&#43;file&#43;and&#43;request&#43;a&#43;review&#43;via&#43;Pull&#43;Request.%0A" class="td-page-meta--child" target="_blank" rel="noopener"><i class="fa fa-edit fa-fw"></i> Create child page</a>
  <a href="https://github.com/icaruslab/docs/issues/new?title=DDoS%20mitigation%20guide" class="td-page-meta--issue" target="_blank" rel="noopener"><i class="fab fa-github fa-fw"></i> Create documentation issue</a>
  <a href="https://github.com/icaruslab/issues/new" class="td-page-meta--project-issue" target="_blank" rel="noopener"><i class="fas fa-tasks fa-fw"></i> Create project issue</a>
  <a id="print" href="../docs/ddos-mitigation-guide/_print.html"><i class="fa fa-print fa-fw"></i> Print entire section</a>

</div>

            


<div class="td-toc"><nav id="TableOfContents">
  <ul>
    <li><a href="#denial-of-service-dos">Denial of Service (DoS)</a></li>
    <li><a href="#distributed-denial-of-service-ddos">Distributed Denial of Service (DDoS)</a></li>
    <li><a href="#how-does-a-ddos-attack-work-what-is-a-botnet">How does a DDos attack work? What is a Botnet?</a></li>
    <li><a href="#identification">Identification</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#mitigation">Mitigation</a>
      <ul>
        <li><a href="#server-configuration-mitigation-measures">Server configuration mitigation measures</a></li>
        <li><a href="#mitigation-using-external-services">Mitigation using external services</a></li>
      </ul>
    </li>
  </ul>
</nav></div>



            

	
		



  
  

	
		



  
  

	

          </aside>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="td-breadcrumbs">
  <ol class="breadcrumb">
  <li class="breadcrumb-item">
    <a href="../docs.html">Documentation</a>
  </li>
  <li class="breadcrumb-item active" aria-current="page">
    <a href="../docs/ddos-mitigation-guide.html">DDoS mitigation guide</a>
  </li>
  </ol>
</nav>
            
<div class="td-content">
	<h1>DDoS mitigation guide</h1>
  <div class="lead">DDoS mitigation guide</div>
	<header class="article-meta">
		
		
			
				


			
				


			
		
		
			<p class="reading-time"><i class="fa fa-clock" aria-hidden="true"></i>&nbsp; 20 minute read &nbsp;</p>

		
	</header>
	<h1 id="summary">Summary</h1>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Who is this guide for?</h4>

    <strong>Is the website you run or manage experiencing slowed performance or constant outages? It could be an issue with configuration, or it could be something more targeted.</strong>

</div>

<p>In the course of our work, we have seen and responded to what we believe was a sophisticated DDoS attack (defined below) that was aimed at effectively censoring an important media platform in the region. In the documentation that follows, we have reflected on this practical experience and consolidated it into a guide to respond to similar attacks.</p>
<p>For publishers, writers or activists that believe they are facing such a targeted attack, we advise you to familiarize yourself with some of the core concepts below, and then pass this documentation guide on to your technical team for the technical configurations that will hopefully get your website back up and running and maximally protected against any attacks in the future.</p>
<h1 id="what-is-ddos">What is DDOS?</h1>
<h2 id="denial-of-service-dos">Denial of Service (DoS)</h2>
<p><strong>Denial of Service (DoS)</strong> attacks are a form of cyber attack that aim to disrupt a specific online service or website on the internet by flooding its infrastructure with a high quantity of false requests exceeding the site’s handling capacity in order to eventually render it inaccessible to its usual audience.</p>
<p>Such methods can be utilized to different ends, but the most common end aims at distributing the service/site, either continuously over time or for a specific period. DoS attacks can also aim to incrementally increase disruptions over time in order to increase the costs of hosting and mitigation.</p>
<h2 id="distributed-denial-of-service-ddos">Distributed Denial of Service (DDoS)</h2>
<p>In the event that you are dealing with a DoS attack, the most effective response would be to simply identify and block the source of the attack on the network level. And with the variety of web application firewall (WAF) services and different traffic control and filtering software employed on modern servers, it can be quite simple to deploy such a response.</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">But what happens when things are more sophisticated?</h4>

    <strong>The task of mitigation and response becomes significantly more difficult when a DoS attack becomes a DDoS attack.</strong>

</div>

<p>As suggested in the name, a Distributed Denial of Service attack is a DoS attack being launched and coordinated using a number of machines — usually compromised devices “distributed” over different networks and geographic locations.</p>
<p>Atop this decentralized layer usually sits various obfuscation techniques that make the malicious requests look as similar as possible to normal traffic. In practical terms, this makes the chance of mistakenly blocking legitimate sources of traffic in the mitigation response significantly higher.</p>
<h2 id="how-does-a-ddos-attack-work-what-is-a-botnet">How does a DDos attack work? What is a Botnet?</h2>
<p>The number of devices connected and exposed to the public internet increases each day. However, there is not a corresponding move to ensure that security benchmarks and software updates are properly and regularly implemented, creating a situation whereby outdated software with publicly known vulnerabilities can be exploited.</p>
<p>This is the case, for example, with a significant amount of Internet of Things (IoT) devices, which are usually devices running simple software, such as coffee machines, printers, smart cameras, routers, etc. These devices have often not regularly been updated to run the latest firmware version or have been left with the default username and password.</p>
<p><strong>A DDos attack relies</strong> on a malicious actor hijacking such vulnerable devices to form a network of malicious devices, or a botnet, through which the actor can then issue specific commands, such as getting them all to keep sending requests to a specific website or server.</p>
<p>The malicious actor can utilize this network of devices to their own benefit or rent it to someone else.
One of the most recent and infamous botnets is the <a href="https://www.malwarebytes.com/what-was-the-mirai-botnet">Mirai botnet</a>.</p>
<h2 id="identification">Identification</h2>
<p>Identifying a DDoS attack in real-time might seem simple enough, but anyone who has gone through the experience of hosting or managing a server that is exposed to the internet knows that there is usually a lot of random noise showing all the time on the server logs that is usually not harmful in nature, such as search engines bots.</p>
<p>This fact makes it more complicated to identify and track the malicious traffic and its sources. It’s also important to determine whether the occurring downtime is a result of a server component malfunction, misconfiguration or an attack.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Note on best practice</h4>

    <p>It’s always a good practice to make sure server logs are well configured and accessible. This is especially the case with any effort to identify and mitigate a DDoS attack. Being able to access and to understand live logs will be a crucial factor in the process.</p>
<p>It’s also important to know which logs to look at. As linux-based distributions (Ubuntu, Redhat, etc.) are the dominant operating system in the server hosting market, we’ll be using it as an example in this case.</p>


</div>

<h5 id="our-example">Our example</h5>
<p><strong>Linux operating systems normally store logs under <code>/var/log/</code>.</strong> In this directory, you’ll find different types of logs:</p>
<ul>
<li>Logs from the operating system and its different components (kernel, hardware management, networking, firewall events)</li>
<li>Logs created by specialized software installed by the user and running on the server, such as web servers (Nginx, Apache), runtime environment for a programming language (PHP, Java, Javascript), or database servers (MySQL, MongoDB)</li>
</ul>
<p><strong>For example</strong>, when trying to identify a DDoS attack on a WordPress-based website, we need to look at logs of the software used to run the website:</p>
<ul>
<li>Web server (Nginx, Apache) <code>/var/log/nginx/</code>
<ul>
<li><code>/var/log/nginx/</code></li>
<li><code>/var/log/apache2/</code></li>
</ul>
</li>
<li>PHP runtime (php-fpm in case of nginx)
<ul>
<li><code>/var/log/php/</code></li>
<li><code>/var/log/php*/</code></li>
</ul>
</li>
<li>Database server (MariaDB, MySQL, MongoDB)
<ul>
<li><code>/var/log/mysql/</code></li>
</ul>
</li>
</ul>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">There are some signs to look for in the logs</h4>

    <hr>
<ul>
<li>A sudden or unusual spike in incoming traffic</li>
<li>Too many requests coming from the same IP addresses or a specific range of addresses over a short period of time</li>
<li>Sudden increase in incoming requests over seemingly random and non-existent pages/urls on the server, returning 404 errors</li>
<li>Increasing number of 403 and 405 errors, indicating service outages as a result of the server exhausting the limit of its hardware capacity causing all types of system errors and eventually crashing</li>
</ul>
<hr>


</div>

<p><strong>If the attacks are operating on HTTP protocol</strong>, the <code>user-agent</code> request header <em>– which is used by software operating within a network protocol to identify itself, e.g.</em> <code>Mozilla/5.0 (platform; rv:geckoversion) Gecko/geckotrail Firefox/firefoxversion</code> – in incoming traffic will look suspicious and can help in the identification process when cross checked with IP addresses.</p>
<p>But, often things aren&rsquo;t so straight forward
Attackers can easily change the <code>user-agent</code> request header used by their software to imitate a specific software such as well known search engine bots or normal browsers, such as Google Chrome or Firefox. (E.g.<code>AdsBot-Google (+http://www.google.com/adsbot.html)</code>).</p>
<h5 id="luckily-a-lot-of-suspicious-user-agents-have-already-been-identified">Luckily, a lot of suspicious user-agents have already been identified</h5>
<p><strong>Example of suspicious user-agents:</strong></p>
<ul>
<li>Baiduspider+(+http://help.baidu.jp/system/05.html)`</li>
<li>Nuclei - Open-source project (github.com/projectdiscovery/nuclei)</li>
</ul>
<p><strong>You can find some public curated lists of potentially malicious user agents</strong></p>
<ul>
<li><a href="https://github.com/fastly/waf_testbed/blob/master/templates/default/scanners-user-agents.data.erb">Fastly scanners user agents</a></li>
<li><a href="https://github.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/blob/master/_generator_lists/bad-user-agents.list">Nginx ultimate bad bot blocker</a></li>
</ul>
<h2 id="mitigation">Mitigation</h2>
<p><strong>The ultimate goal of a targeted DDoS attack is</strong> to exhaust the target’s available resources over time, making it increasingly difficult to support the infrastructure needed for the website and the technical expertise required to keep it running against the attack.</p>
<p><strong>That means</strong>, successful mitigation will hinge on detecting and either blocking or throttling most of the malicious requests.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">What you'll find in the sections below</h4>

    <p>We detail two principal approaches that can be used in combination to create a robust mitigation approach:</p>
<ol>
<li>server configuration mitigation measures and</li>
<li>mitigation through the use an external service, such as web application firewalls, content delivery networks and caching.</li>
</ol>


</div>

<h3 id="server-configuration-mitigation-measures">Server configuration mitigation measures</h3>
<p>We outline, below, a number of useful software that can be installed on the server that can be helpful in DDoS mitigation: Fail2ban and Crowdsec.</p>
<h4 id="fail2ban">Fail2ban</h4>
<p><a href="https://github.com/fail2ban/fail2ban">Fail2ban</a> is a UNIX-like systems specific software (Linux, BSD, macOS). The main function of Fail2ban is to monitor a specific set of system logs and identify malicious behavior based on sets of rules and predefined patterns. Fail2ban needs to be configured according to the nature and known attack vectors of the targeted software/service.</p>
<p>The firewall software installed on the server can then be utilized to block the detected bad actors for a specific time or indefinitely.</p>
<p>Fail2ban is a very flexible software and can be configured to monitor a wide variety of services and endpoints. However, setting up and successfully configuring everything for multiple services can be a bit tricky at first.</p>
<h5 id="fail2ban-configuration-files-are-organized-this-way">Fail2ban configuration files are organized this way:</h5>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>/etc/fail2ban/
</span></span><span style="display:flex;"><span>├── action.d
</span></span><span style="display:flex;"><span>├── fail2ban.d
</span></span><span style="display:flex;"><span>├── filter.d
</span></span><span style="display:flex;"><span>│   └── ignorecommands
</span></span><span style="display:flex;"><span>└── jail.d
</span></span></code></pre></div><hr>
<h5 id="what-are-jails">What are jails?</h5>
<p>Jails are used to control and define the service we need to monitor. Take the example where we are creating a jail to ban IP addresses that are getting a lot of forbidden errors on their requests, which means they are attempting to access a restricted endpoint repeatedly.</p>
<p>In this scenario, we need to create and set the name of the filter we are going to create later, the action, and the path of the log file we are monitoring.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff79c6">[</span>nginx-forbidden<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">enabled</span> <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">true</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">filter</span> <span style="color:#ff79c6">=</span> nginx-forbidden
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">action</span> <span style="color:#ff79c6">=</span> iptables-multiport<span style="color:#ff79c6">[</span><span style="color:#8be9fd;font-style:italic">name</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;nginx-forbidden&#34;</span>, <span style="color:#8be9fd;font-style:italic">port</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;http,https&#34;</span><span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">logpath</span> <span style="color:#ff79c6">=</span> /var/log/nginx/*error*.log
</span></span></code></pre></div><hr>
<h5 id="what-are-filters">What are filters?</h5>
<p>Filters define the patterns to look for in the log files. The filter uses regular expressions to define the pattern. We also have the ability to define a pattern that should be ignored, which can be useful to whitelist specific requests.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff79c6">[</span>Definition<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">failregex</span> <span style="color:#ff79c6">=</span> ^ <span style="color:#f1fa8c">\[</span>error<span style="color:#f1fa8c">\]</span> <span style="color:#f1fa8c">\d</span>+#<span style="color:#f1fa8c">\d</span>+: .* forbidden .*, client: &lt;HOST&gt;, .*$
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">ignoreregex</span> <span style="color:#ff79c6">=</span>
</span></span></code></pre></div><hr>
<h5 id="what-are-actions">What are actions?</h5>
<p>Actions are used to define how Fail2ban will respond after identifying the pattern defined in the filter. Actions can be used, for example, to block the offending IP addresses using the firewall UFW (Uncomplicated Firewall).
Ultimately executing a command that looks like <code>ufw deny from xxx.xxx.xxx.xxx to any</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#6272a4"># Fail2Ban action configuration file for ufw</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">#</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># You are required to run &#34;ufw enable&#34; before this will have any effect.</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">#</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># The insert position should be appropriate to block the required traffic.</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># A number after an allow rule to the application won&#39;t be of much use.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>Definition<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">actionstart</span> <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">actionstop</span> <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">actioncheck</span> <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">actionban</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">[</span> -n <span style="color:#f1fa8c">&#34;&lt;application&gt;&#34;</span> <span style="color:#ff79c6">]</span> <span style="color:#ff79c6">&amp;&amp;</span> <span style="color:#8be9fd;font-style:italic">app</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;app &lt;application&gt;&#34;</span>
</span></span><span style="display:flex;"><span>ufw insert &lt;insertpos&gt; &lt;blocktype&gt; from &lt;ip&gt; to &lt;destination&gt; <span style="color:#8be9fd;font-style:italic">$app</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">actionunban</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">[</span> -n <span style="color:#f1fa8c">&#34;&lt;application&gt;&#34;</span> <span style="color:#ff79c6">]</span> <span style="color:#ff79c6">&amp;&amp;</span> <span style="color:#8be9fd;font-style:italic">app</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;app &lt;application&gt;&#34;</span>
</span></span><span style="display:flex;"><span>ufw delete &lt;blocktype&gt; from &lt;ip&gt; to &lt;destination&gt; <span style="color:#8be9fd;font-style:italic">$app</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>Init<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Option: insertpos</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Notes.: The position number in the firewall list to insert the block rule</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">insertpos</span> <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Option: blocktype</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Notes.: reject or deny</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">blocktype</span> <span style="color:#ff79c6">=</span> reject
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Option: destination</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Notes.: The destination address to block in the ufw rule</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">destination</span> <span style="color:#ff79c6">=</span> any
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Option: application</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Notes.: application from sudo ufw app list</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">application</span> <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># DEV NOTES:</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">#</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Author: Guilhem Lettron</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Enhancements: Daniel Black</span>
</span></span></code></pre></div><hr>
<h4 id="crowdsec">Crowdsec</h4>
<p>If the process of configuring Fail2ban seemed a bit too complicated, Crowdsec, an open-source project built on similar principles as Fail2ban, should be very helpful.</p>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube-nocookie.com/embed/t99cnWYGhdw" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>



<div class="pageinfo pageinfo-primary">
<p>CrowdSec is a free, modern &amp; collaborative behavior detection engine, coupled with a global IP reputation network. It stacks on Fail2ban&rsquo;s philosophy but is IPV6 compatible and 60x faster (Go vs Python), uses Grok patterns to parse logs and YAML scenario to identify behaviors.
CrowdSec is engineered for modern Cloud / Containers / VM-based infrastructures (by decoupling detection and remediation). Once detected, you can remedy threats with various bouncers (firewall block, nginx http 403, Captchas, etc.), while the aggressive IP can be sent to CrowdSec for curation before being shared among all users to further improve everyone&rsquo;s security. — <strong>Crowdsec developers</strong></p>

</div>

<p>As the developers describe it above, Crowdsec functions in a way similar to Fail2ban but comes with more features and is way simpler to set up.
Another key feature of Crowdsec is the sharing of offending IP addresses across the community using it, effectively creating a community driven IP reputation system.</p>
<p>For instruction purposes, say we are looking at a simple installation of Crowdsec to monitor incoming traffic to a Wordpress instance, but, first, we need to briefly define some of the inner parts of the software in order to get an initial understanding of how it functions.
Crowdsec offers great documentation, which you can find <a href="https://docs.crowdsec.net/docs/getting_started/install_crowdsec">here</a>.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Building on the work of others</h4>

    We will be using Crowdsec’s own documentations.
You can refer to the <a href="https://doc.crowdsec.net/docs/concepts">concepts</a> page for a better understanding of the software components.

</div>

<p><strong>First</strong>, we need to install Crowdsec.
Refer to the <a href="https://docs.crowdsec.net/docs/getting_started/install_crowdsec">installation page</a> for installation instruction specific to your operating system.</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Note on best practice</h4>

    <p>While it’s possible to have Crowdsec installed on a standalone server, it’s much easier to have it running on the same machine as the target website. Installing it on a standalone server would require additional configurations for authentication and security.</p>
<p>To install Crowdsec on a standalone server, you can consult Crowdsec’s docs, <a href="https://docs.crowdsec.net/docs/configuration/crowdsec_configuration#tls">here</a>.</p>


</div>

<h5 id="our-example-1">Our example</h5>
<p><strong>To install on Ubuntu/Debian, run:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -s https://packagecloud.io/install/repositories/Crowdsec/Crowdsec/script.deb.sh | sudo bash
</span></span><span style="display:flex;"><span>apt install Crowdsec
</span></span></code></pre></div><p><strong>And then initiate the configuration wizard:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>/usr/share/Crowdsec/wizard.sh -c
</span></span></code></pre></div><p><strong>The configuration wizard will appear.</strong></p>
<p><strong>First, the script scans for logs on your system and which software they belong to. You can deselect services that you don’t want Crowdsec to monitor.</strong></p>
<p><img src="../images/ddos/1.png" alt=""></p>
<p><strong>Here, you need to select the “collections” that fit your use case.</strong></p>
<p>”Collections” contain ”parsers” which help the software understand how to process the logs produced by a specific software and “scenarios” that are used to describe the attack scenario and how it should look in the logs as a pattern.</p>
<p><img src="../images/ddos/2.png" alt=""></p>
<p><strong>Some of the suggested collections in this example</strong></p>
<ul>
<li>Crowdsecurity/whitelist-good-actors</li>
<li>Crowdsecurity/wordpress</li>
<li>Crowdsecurity/http-cve</li>
<li>Crowdsecurity/apache2</li>
<li>Crowdsecurity/nginx</li>
</ul>
<p><strong>In the next stage, we can confirm the detected individual log files for every software. We can deselect any file we don’t want monitored.</strong></p>
<p><img src="../images/ddos/3.png" alt=""></p>
<p><img src="../images/ddos/4.png" alt=""></p>
<hr>
<p><strong>Now, we need to install the Crowdsec <a href="https://wordpress.org/plugins/crowdsec/">Wordpress plugin</a> on the targeted instance.</strong></p>
<p>The plugin is available on Wordpress plugin store, and it can be downloaded from the <a href="https://github.com/crowdsecurity/cs-wordpress-bouncer/releases/latest">project Github</a> as well.</p>
<p><img src="../images/ddos/5.png" alt=""></p>
<p><strong>Once the plugin is installed and enabled, it should be accessible from the Wordpress dashboard.</strong></p>
<p><img src="../images/ddos/6.png" alt=""></p>
<p><strong>The first thing to set here is the <code>Local API URL</code>,</strong> which is the address of the server that’s running Crowdsec. If it’s installed on the same machine as the Wordpress instance, it should be set to <code>http://localhost:8080</code></p>
<p>Now, <strong>we need to go back to the command line to generate the <code>Bouncer API key</code>.</strong> The bouncer will be used to authenticate its connection with Crowdsec.</p>
<p><strong>Now, we get the key by running:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cscli bouncers add wordpress-bouncer
</span></span></code></pre></div><p><strong>The result should be a random key that looks like this:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Api key <span style="color:#ff79c6">for</span> <span style="color:#f1fa8c">&#39;wordpress-bouncer&#39;</span>:
</span></span><span style="display:flex;"><span> 4df97788c6a4967ba16cbd689d2395df
</span></span><span style="display:flex;"><span>Please keep this key since you will not be able to retrieve it!
</span></span></code></pre></div><p>After we test these settings and confirm the connection between the Wordpress plugin and Crowdsec is working, <strong>there are some settings in the plugin that we can use to fine-tune the bouncing process and make it work best for our use case.</strong></p>
<p><strong>Here, we can customize the message that will be shown to a banned/bounced client.</strong></p>
<p><img src="../images/ddos/7.png" alt=""></p>
<p><strong>The default looks like this:</strong></p>
<p><img src="../images/ddos/14.png" alt=""></p>
<p><strong>We then need to open the advanced settings tab</strong></p>
<p><img src="../images/ddos/9.png" alt=""></p>
<p><strong>First, we need to enable <code>stream mode</code> and lower the <code>Resync decision each</code>.</strong></p>
<p><img src="../images/ddos/10.png" alt=""></p>
<p>In this example, <strong>we will set the Resync intervals to every 5 seconds.</strong>
This basically controls the intervals of fetching new <code>decisions</code> from Crowdsec.
But there is room for experimentation and adjustment to fine-tune these settings for each use case.</p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Other important settings to check</h4>

    <p>If you are using a specific content delivery network (CDN), such as Cloudflare or Fastly, your website is being served either partially or completely from the CDN’s own IP addresses.</p>
<p>That means that the requests coming to your server will also be from the CDN and not directly from the client.
To be able to see and log the original IP addresses of the request, CDNs usually use a specific header in the HTTP packet called <code>X-Forward-For</code>. Adding the public IP ranges of your CDN here will tell Crowdsec to trust the requests coming from them and to look for the <code>X-Forward-For</code> HTTP header` to get the original source of the request.</p>


</div>

<h5 id="how-to-whitelist-cdns">How to whitelist CDNs</h5>
<p><img src="../images/ddos/11.png" alt=""></p>
<p>Most CDN services usually publish a list of their public IP ranges so they can be whitelisted. <strong>Find the IP ranges for two major CDN services below:</strong></p>
<ul>
<li><a href="https://www.cloudflare.com/ips/">Cloudflare</a></li>
<li><a href="https://support.google.com/a/answer/10026322?hl=en">Google</a></li>
</ul>
<p><strong>It’s also important to check the caching settings here:</strong></p>
<p><img src="../images/ddos/12.png" alt=""></p>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Note that</h4>

    <p>Some of these settings aren&rsquo;t applicable when stream mode is enabled.</p>
<p>For a more detailed overview on how <code>stream mode</code> functions in Crowdsec, take a look at the developer’s <a href="https://docs.crowdsec.net/docs/local_api/bouncers#stream-mode">documentation</a>.</p>


</div>

<p><strong>Now, we need to choose the <code>Bouncing Level</code>. There are three choices</strong></p>
<ul>
<li><strong>Bouncing disabled:</strong> No ban or Captcha display to users. The road is free, even for attackers. (No action will be taken)</li>
<li><strong>Flex bouncing:</strong> Display Captcha only, even if CrowdSec advises to ban the IP.</li>
<li><strong>Normal bouncing:</strong> Follow CrowdSec advice (Ban or Captcha).</li>
</ul>


<div class="alert alert-primary" role="alert">


    <p><strong>Tip:</strong></p>
<p><code>Normal Bouncing</code> would be the best option if you are facing an imminent or persistent attack. <code>Flex bouncing</code> will only use captcha even if the decision from Crowdsec was <code>ban</code>. That will help in reducing the false positive bans to legitimate visitors when there is no attack.</p>


</div>

<h5 id="how-to-test-the-communication-between-crowdsec-and-the-wordpress-plugin">How to test the communication between Crowdsec and the Wordpress plugin.</h5>
<p>We can manually ban a specific IP address using Crowdsec Then, we can observe how long it takes for the plugin to pick up the decision.</p>
<p><strong>To manually enforce a decision, we need to run:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>cscli decisions add –ip xxx.xxx.xxx.xxx
</span></span></code></pre></div><p><strong>To check the current decisions, run:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>cscli decisions list
</span></span></code></pre></div><p><strong>We should find our banned address here</strong>
<img src="../images/ddos/13.png" alt=""></p>
<p>Now, if everything is working properly, <strong>we should get the following prompt screen when we try to access the website from the banned address.</strong></p>
<p><img src="../images/ddos/14.png" alt=""></p>
<p>Depending on the settings we discussed before, the plugin might take some time to synchronize the decisions from the API. <strong>Adjusting this time window can help increase the effectiveness of mitigating different types of attacks.</strong></p>
<p>For example, to respond to an attack using a wide range of IP addresses from different locations, we will need to minimize the synchronization time as much as possible.
However, we need to adjust the parameters gradually to prevent overwhelming the hardware capacities of the server or creating too many background requests.</p>
<p>Getting the most suitable parameters for each machine, server setup, and attack scenario will take some fiddling and observation.</p>
<h5 id="technical-notes">Technical notes</h5>
<p><strong>WP-Cron</strong></p>
<p>By default, WordPress uses WP-Cron to schedule its routine tasks. This should be sufficient in most cases. However, in some cases – especially with resource-hungry websites – using the operating system&rsquo;s own scheduler might be better for performance.</p>
<p>Some custom Wordpress themes and plugins might be affected by changing this configuration, please consult the documentations below before trying</p>
<ul>
<li><a href="https://developer.wordpress.org/plugins/cron/hooking-wp-cron-into-the-system-task-scheduler/">Hooking WP-Cron Into the System Task Scheduler</a></li>
<li><a href="https://docs.Crowdsec.net/docs/bouncers/wordpress/#how-to-use-system-cron-instead-of-wp-cron">How to use system CRON instead of wp-cron?</a></li>
</ul>
<p><strong>Caching and external scripts</strong></p>
<p>Crowdsec will monitor and react to all requests going through normal Wordpress core loading.
In some cases, such as some caching or content management plugins, external PHP scripts are run directly. Consult your website developer and review the installed and activated plugins, and if that is the case, check out the documentation, here.</p>
<p><strong>Other use cases</strong></p>
<p>Crowdsec has bouncers for other services and use cases. You can check them out, here.</p>
<p><strong>Guides for different Crowdsec configuration scenarios</strong></p>
<ul>
<li><a href="https://docs.Crowdsec.net/docs/bouncers/wordpress/">Crowdsec bouncer for wordpress</a></li>
<li><a href="https://docs.Crowdsec.net/docs/local_api/bouncers#stream-mode">What is stream mode</a></li>
<li><a href="https://www.Crowdsec.net/blog/installing-and-configuring-Crowdsec-into-cloudflare">Using Crowdsec alongside Cloudflare</a></li>
<li><a href="https://www.Crowdsec.net/blog/mitigate-ddos-with-Crowdsec">Configuration example for DDoS mitigation</a></li>
<li><a href="https://docs.Crowdsec.net/docs/getting_started/install_Crowdsec/">Guide on Crowdsec installation</a></li>
<li><a href="https://github.com/Crowdsecurity/cs-wordpress-bouncer/blob/main/docs/USER_GUIDE.md#description">Guide on Wordpress bouncer configuration</a></li>
<li><a href="https://www.Crowdsec.net/blog/how-to-beat-application-ddos">Guide on best practices for application layer DDoS mitigation</a></li>
</ul>
<hr>
<h4 id="best-practices-and-server-optimization">Best practices and server optimization</h4>
<p>Following best practices while creating and configuring the server will be of great help in the event of dealing with a DDoS attack. One very important aspect is using different server caching mechanisms and optimizing server performance and capacity.</p>
<p>Caching means the server will keep a cached (pre-rendered) copy of the content and serve it directly without the need to run the whole code and render a new result for every request, as long as the content is unchanged. This will not only help with DDoS resilience and mitigation but will provide improvement to the overall performance of the website or service.</p>
<p><strong>For example</strong>, enabling caching using Nginx fastcgi or Redis helps reduce the load on the hosting server as it serves pre-rendered content as long as no changes were made to the content on the website.</p>
<ul>
<li><a href="https://www.linode.com/docs/guides/how-to-use-nginx-fastcgi-page-cache-with-wordpress/">Guide to Nginx fastcgi configuration</a></li>
<li><a href="https://www.digitalocean.com/community/tutorials/how-to-configure-redis-caching-to-speed-up-wordpress-on-ubuntu-14-04">Guide to Redis caching configuration</a></li>
<li><a href="https://wordops.net/f-a-q/">Using Wordops to automate Wordpress-based website installation and configuration with recommended best practices in mind</a></li>
</ul>
<hr>
<h3 id="mitigation-using-external-services">Mitigation using external services</h3>
<p>Alongside the measures that can be implemented through self-hosted server configuration, there are a number of external services that can also aid in DDoS mitigation.</p>
<p>Where self-hosted server configuration allows for a higher degree of specialization and gives you complete control over the flow of your data, the range of external services discussed below – which include web application firewalls, content delivery networks, and caching – bring the benefits of a wider net born out of the more macro view these service providers have.</p>
<p><strong>Before jumping into the potential services</strong>, let’s take a moment to explain each of these services. Ultimately, many service providers offer a mix of the various services in a single offer, but it is helpful to understand each of them in isolation.</p>
<h4 id="web-application-firewall-waf">Web application firewall (WAF)</h4>
<p>A Web application firewall (WAF) is a custom type of firewall software that is specifically designed to work with specific types of applications. It can thus be configured to monitor all traffic related to this application, detect certain patterns and indications of malicious behavior, and respond to it using pre-set rules.</p>
<h4 id="content-delivery-network-cdn">Content delivery network (CDN)</h4>
<p>CDN services such as Cloudflare, Google Cloud CDN, and others all employ a global network of content caching and delivery networks, basically caching and storing parts of the website that doesn’t change so often and serving the cached data to the visitor from the nearest server to their geographical location, ultimately decreasing latency, improving load times, the overall performance for the website, and most importantly– for our case here – reducing the load and processing demands on the origin server.</p>
<h4 id="caching">Caching</h4>
<p>Alongside caching tactics that can be implemented on the server in order to serve pre-rendered content, external services also have their own caching mechanisms that can help optimize performance and prevent resource drains.</p>
<h4 id="cloudflare">Cloudflare</h4>
<p>Cloudflare offers a variety of web services. Here, we will focus only on services that are most effective for DDoS mitigation.</p>
<h5 id="project-galileo">Project Galileo</h5>
<p>Some of the features we will be recommending in this guide aren&rsquo;t available on Cloudflare’s free tier. However, since the main targeted audience here are NGOs, human rights related content, and independent media organizations, there is a dedicated program through which Cloudflare offers support for organizations that might fit that criteria.</p>
<p>For more information on project Galileo and how to <a href="https://www.cloudflare.com/galileo/">apply</a>, see here.</p>
<h5 id="live-logs">Live logs</h5>
<p>One of the most important features will be the intuitive events processing and filtering interface.</p>
<p>Through this interface, we can monitor the requests coming to the website as well as search through the logs using advanced filters, which will help in identifying the patterns of the attack and create specific firewall rules to mitigate.</p>
<p><img src="../images/ddos/15.png" alt=""></p>
<p>We are also able to search through the events using advanced filters. For example, we can search all the traffic coming from a specific country which is requesting a specific path.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Learn more</h4>

    Click <a href="https://developers.cloudflare.com/logs/reference/log-fields/zone/firewall_events/">here</a> to find out more about Cloudflare Firewall Events interface.

</div>

<h5 id="web-application-firewall-waf-1">Web Application Firewall (WAF)</h5>
<p>On Cloudflare, we can create sets of custom access control and firewall rules, configure them to trigger certain responses based on certain rules and indications, and we can also arrange them in terms of priority.</p>
<p>Cloudflare offers some automated firewall rules as well, specifically curated for well known attack vectors for various widely used applications, such as Wordpress or Drupal, or attack vectors, such as SQL injection or DDoS attacks.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Learn more</h4>

    You can review more about Cloudflare’s managed rules, <a href="https://developers.cloudflare.com/waf/managed-rules/">here</a>.

</div>

<h5 id="rate-limiting">Rate Limiting</h5>
<p><strong>Rate limiting</strong> is a very important feature in DDoS mitigation. How it ultimately works is through setting rules that limit the amount of requests allowed from a specific source. See the setting window below:</p>
<p><img src="../images/ddos/16.png" alt=""></p>
<p>After the pre-set amount is exceeded a certain measure will be triggered. The response can include blocking the source for a period of time or indefinitely. Alternatively, it can be “challenged,” which means requests coming from the potentially malicious source will be redirected to what can be described as “an obstacle page” to slow down and verify its requests.</p>
<p>This obstacle can include a CAPTCHA or simply a loading page that redirects to the original website after a short wait.
You can read more on rate limiting on Cloudflare, <a href="https://developers.cloudflare.com/waf/rate-limiting-rules/">here</a>.</p>


<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">Learn more</h4>

    You can also read about Cloudflare’s automated DDoS protection, <a href="https://developers.cloudflare.com/ddos-protection/">here</a>.

</div>

<hr>
<h4 id="google-shield">Google Shield</h4>
<p><strong>Shield</strong> is a DDoS protection service developed and maintained by the <a href="https://jigsaw.google.com/">Jigsaw</a> unit at Google. The service is focused on <a href="https://support.projectshield.withgoogle.com/s/?language=en_US">supporting</a> independent media organizations, news outlets, and human rights organizations that could face DDoS attacks.</p>
<p>Shield offers a DDoS protection <a href="https://support.projectshield.withgoogle.com/s/article/FAQs?language=en_US">service</a> that leverages a combination of caching and automated rate-limiting to mitigate DDoS attacks. It functions as a reverse-proxy standing between the origin server and the visitor/client, serving the cached content through Google’s content distribution network (CDN).</p>
<p>The service is offered for free. You do, however, need to apply for it. Check out the application instructions and criteria <a href="https://support.projectshield.withgoogle.com/s/article/How-to-apply-for-Project-Shield?language=en_US">here</a>.</p>
<hr>
<h4 id="deflect">Deflect</h4>
<p><a href="https://deflect.ca">Deflect</a> is a DDoS mitigation service built by <a href="https://equalit.ie/">eQualitie</a>. The service is focused on supporting non-profit organizations at risk.</p>
<p>You can check the supported criteria and application instructions <a href="https://deflect.ca/non-profits/">here</a>.</p>
<hr>

        <div class="section-index">
    
    
    
    
    
    
    
    
    
</div>

	
	
	<div class="text-muted mt-5 pt-3 border-top">
  Last modified February 28, 2023: <a href="https://github.com/icaruslab/docs/commit/ee58595266600510ceb0bd4eec5ef08fc22b41f5">DDoS docs (ee58595)</a>
</div>

</div>

          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Matrix channel" aria-label="Matrix channel">
    <a class="text-white" target="_blank" rel="noopener" href="https://matrix.to/#/!kxgkaasHfjVIgsDvlx:matrix.org?via=matrix.org" aria-label="Matrix channel">
      <i class="fa fa-comment"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
    <a class="text-white" target="_blank" rel="noopener" href="https://twitter.com/IcarusProject0" aria-label="Twitter">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Mastodon" aria-label="Mastodon">
    <a class="text-white" target="_blank" rel="noopener" href="https://mastodon.online/web/accounts/41742" aria-label="Mastodon">
      <i class="fab fa-mastodon"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/icaruslab" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Send us an email" aria-label="Send us an email">
    <a class="text-white" target="_blank" rel="noopener" href="mailto:info@fightcensorship.tech" aria-label="Send us an email">
      <i class="fa fa-at"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GPG Key" aria-label="GPG Key">
    <a class="text-white" target="_blank" rel="noopener" href="https://keyserver.ubuntu.com/pks/lookup?op=get&amp;search=0x8982de90bb823122bed49ba7b055b6a6adf40cda" aria-label="GPG Key">
      <i class="fa fa-key"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2023 GPLv3, All Rights Reserved</small>
        
	
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
    integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js"
    integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA=="
    crossorigin="anonymous"></script>


<script src="https://cdn.jsdelivr.net/npm/mermaid@8.13.4/dist/mermaid.min.js" integrity="sha512-JERecFUBbsm75UpkVheAuDOE8NdHjQBrPACfEQYPwvPG+fjgCpHAz1Jw2ci9EXmd3DdfiWth3O3CQvcfEg8gsA==" crossorigin="anonymous"></script>




<script src='../js/tabpane-persist.js'></script>




















<script src="../js/main.min.4775ce3b12b91f0032b9270bbceb5bb5634f8b87faf00c42d5cd537bc7392ce5.js" integrity="sha256-R3XOOxK5HwAyuScLvOtbtWNPi4f68AxC1c1Te8c5LOU=" crossorigin="anonymous"></script>




  </body>
</html>